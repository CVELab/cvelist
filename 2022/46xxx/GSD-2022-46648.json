{
    "GSD": {
        "alias": "CVE-2022-46648",
        "id": "GSD-2022-46648"
    },
    "gsd": {
        "osvSchema": {
            "schema_version": "1.4.0",
            "id": "GSD-2022-46648",
            "modified": "2023-01-05T00:00:00.000Z",
            "published": "2023-01-05T00:00:00.000Z",
            "aliases": [
                "CVE-2022-46648",
                "GHSA-pfpr-3463-c6jh"
            ],
            "summary": "Potential remote code execution in ruby-git",
            "details": "The git gem, between versions 1.2.0 and 1.12.0, incorrectly parsed the output\nof the 'git ls-files' command using eval() to unescape quoted file names.\nIf a file name was added to the git repository contained special characters,\nsuch as '\\n', then the 'git ls-files' command would print the file name in\nquotes and escape any special characters.\nIf the 'Git#ls_files' method encountered a quoted file name it would use\neval() to unquote and unescape any special characters, leading to potential\nremote code execution. Version 1.13.0 of the git gem was released which\ncorrectly parses any quoted file names.\n",
            "severity": [
                {
                    "type": "CVSS_V3",
                    "score": 5.5
                }
            ],
            "affected": [
                {
                    "package": {
                        "ecosystem": "RubyGems",
                        "name": "git",
                        "purl": "pkg:gem/git"
                    }
                }
            ],
            "references": [
                {
                    "type": "WEB",
                    "url": "https://github.com/ruby-git/ruby-git/pull/602"
                },
                {
                    "type": "WEB",
                    "url": "https://github.com/ruby-git/ruby-git/releases/tag/v1.13.0"
                }
            ]
        }
    },
    "namespaces": {
        "cve.org": {
            "CVE_data_meta": {
                "ASSIGNER": "vultures@jpcert.or.jp",
                "ID": "CVE-2022-46648",
                "STATE": "PUBLIC"
            },
            "affects": {
                "vendor": {
                    "vendor_data": [
                        {
                            "product": {
                                "product_data": [
                                    {
                                        "product_name": "ruby-git",
                                        "version": {
                                            "version_data": [
                                                {
                                                    "version_value": "versions prior to v1.13.0"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "vendor_name": "ruby-git"
                        }
                    ]
                }
            },
            "data_format": "MITRE",
            "data_type": "CVE",
            "data_version": "4.0",
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "ruby-git versions prior to v1.13.0 allows a remote authenticated attacker to execute an arbitrary ruby code by having a user to load a repository containing a specially crafted filename to the product. This vulnerability is different from CVE-2022-47318."
                    }
                ]
            },
            "problemtype": {
                "problemtype_data": [
                    {
                        "description": [
                            {
                                "lang": "eng",
                                "value": "Code injection"
                            }
                        ]
                    }
                ]
            },
            "references": {
                "reference_data": [
                    {
                        "name": "https://github.com/ruby-git/ruby-git",
                        "refsource": "MISC",
                        "url": "https://github.com/ruby-git/ruby-git"
                    },
                    {
                        "name": "https://github.com/ruby-git/ruby-git/pull/602",
                        "refsource": "MISC",
                        "url": "https://github.com/ruby-git/ruby-git/pull/602"
                    },
                    {
                        "name": "https://jvn.jp/en/jp/JVN16765254/index.html",
                        "refsource": "MISC",
                        "url": "https://jvn.jp/en/jp/JVN16765254/index.html"
                    },
                    {
                        "name": "[debian-lts-announce] 20230130 [SECURITY] [DLA 3303-1] ruby-git security update",
                        "refsource": "MLIST",
                        "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00043.html"
                    }
                ]
            }
        },
        "nvd.nist.gov": {
            "configurations": {
                "CVE_data_version": "4.0",
                "nodes": [
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:a:ruby-git_project:ruby-git:*:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "versionEndExcluding": "1.13.0",
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    },
                    {
                        "children": [],
                        "cpe_match": [
                            {
                                "cpe23Uri": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
                                "cpe_name": [],
                                "vulnerable": true
                            }
                        ],
                        "operator": "OR"
                    }
                ]
            },
            "cve": {
                "CVE_data_meta": {
                    "ASSIGNER": "vultures@jpcert.or.jp",
                    "ID": "CVE-2022-46648"
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "en",
                            "value": "ruby-git versions prior to v1.13.0 allows a remote authenticated attacker to execute an arbitrary ruby code by having a user to load a repository containing a specially crafted filename to the product. This vulnerability is different from CVE-2022-47318."
                        }
                    ]
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "en",
                                    "value": "CWE-94"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://github.com/ruby-git/ruby-git/pull/602",
                            "refsource": "MISC",
                            "tags": [
                                "Patch",
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/ruby-git/ruby-git/pull/602"
                        },
                        {
                            "name": "https://github.com/ruby-git/ruby-git",
                            "refsource": "MISC",
                            "tags": [
                                "Product",
                                "Third Party Advisory"
                            ],
                            "url": "https://github.com/ruby-git/ruby-git"
                        },
                        {
                            "name": "https://jvn.jp/en/jp/JVN16765254/index.html",
                            "refsource": "MISC",
                            "tags": [
                                "Third Party Advisory"
                            ],
                            "url": "https://jvn.jp/en/jp/JVN16765254/index.html"
                        },
                        {
                            "name": "[debian-lts-announce] 20230130 [SECURITY] [DLA 3303-1] ruby-git security update",
                            "refsource": "MLIST",
                            "tags": [
                                "Mailing List",
                                "Third Party Advisory"
                            ],
                            "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00043.html"
                        }
                    ]
                }
            },
            "impact": {
                "baseMetricV3": {
                    "cvssV3": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 8.0,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "exploitabilityScore": 2.1,
                    "impactScore": 5.9
                }
            },
            "lastModifiedDate": "2023-02-02T18:45Z",
            "publishedDate": "2023-01-17T10:15Z"
        },
        "github.com/rubysec/ruby-advisory-db": {
            "gem": "git",
            "cve": "2022-46648",
            "ghsa": "pfpr-3463-c6jh",
            "url": "https://github.com/ruby-git/ruby-git/pull/602",
            "title": "Potential remote code execution in ruby-git",
            "date": "2023-01-05",
            "description": "The git gem, between versions 1.2.0 and 1.12.0, incorrectly parsed the output\nof the 'git ls-files' command using eval() to unescape quoted file names.\nIf a file name was added to the git repository contained special characters,\nsuch as '\\n', then the 'git ls-files' command would print the file name in\nquotes and escape any special characters.\nIf the 'Git#ls_files' method encountered a quoted file name it would use\neval() to unquote and unescape any special characters, leading to potential\nremote code execution. Version 1.13.0 of the git gem was released which\ncorrectly parses any quoted file names.\n",
            "cvss_v3": 5.5,
            "unaffected_versions": [
                "< 1.2.0"
            ],
            "patched_versions": [
                ">= 1.13.0"
            ],
            "related": {
                "url": [
                    "https://github.com/ruby-git/ruby-git/releases/tag/v1.13.0"
                ]
            }
        }
    }
}
