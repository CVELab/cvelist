modules:
  - module: github.com/aws/aws-sdk-go
    versions:
      - fixed: 1.34.0
    vulnerable_at: 1.33.21
    packages:
      - package: github.com/aws/aws-sdk-go/service/s3/s3crypto
        symbols:
          - DecryptionClient.GetObjectRequest
          - DecryptionClient.GetObjectWithContext
          - EncryptionClient.PutObject
          - EncryptionClient.PutObjectRequest
          - EncryptionClient.PutObjectWithContext
          - NewKMSKeyGeneratorWithMatDesc
          - NewKMSKeyGeneratorWithMatDesc
          - cekFromEnvelope
          - contentCipherFromEnvelope
          - generateBytes
        derived_symbols:
          - DecryptionClient.GetObject
          - DecryptionClientV2.GetObject
          - DecryptionClientV2.GetObjectWithContext
          - EncryptionClientV2.PutObject
          - EncryptionClientV2.PutObjectWithContext
          - NewKMSKeyGenerator
          - S3SaveStrategy.Save
          - kmsKeyHandler.DecryptKey
          - kmsKeyHandler.DecryptKeyWithContext
          - kmsKeyHandler.GenerateCipherData
          - kmsKeyHandler.GenerateCipherDataWithCEKAlg
          - kmsKeyHandler.GenerateCipherDataWithCEKAlgWithContext
          - kmsKeyHandler.GenerateCipherDataWithContext
description: |-
    The Go AWS S3 Crypto SDK has a vulnerability that can result in loss of
    confidentiality and message forgery. The attack requires write access to the
    bucket in question, and that the attacker has access to an endpoint that
    reveals decryption failures (without revealing the plaintext) and that when
    encrypting the Galois/Counter Mode option was chosen as content cipher.
published: 2022-02-11T23:26:26Z
last_modified: 2022-08-13T03:06:40Z
cves:
  - CVE-2020-8911
ghsas:
  - GHSA-f5pg-7wfw-84q9
credit: Sophie Schmieg from the Google ISE team
links:
    pr: https://github.com/aws/aws-sdk-go/pull/3403
    commit: https://github.com/aws/aws-sdk-go/commit/ae9b9fd92af132cfd8d879809d8611825ba135f4
    advisory: https://github.com/advisories/GHSA-7f33-f4f5-xwgw
    context:
      - https://aws.amazon.com/blogs/developer/updates-to-the-amazon-s3-encryption-client/?s=09
      - https://github.com/aws/aws-sdk-go/commit/1e84382fa1c0086362b5a4b68e068d4f8518d40e
      - https://github.com/sophieschmieg/exploits/tree/master/aws_s3_crypto_poc
