id: PYSEC-2021-25
package:
  name: matrix-synapse
  ecosystem: PyPI
summary: Vulnerability in matrix-synapse
details: Synapse is a Matrix reference homeserver written in python (pypi package
  matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and
  VoIP. In Synapse before version 1.28.0 requests to user provided domains were not
  restricted to external IP addresses when transitional IPv6 addresses were used.
  Outbound requests to federation, identity servers, when calculating the key validity
  for third-party invite events, sending push notifications, and generating URL previews
  are affected. This could cause Synapse to make requests to internal infrastructure
  on dual-stack networks. See referenced GitHub security advisory for details and
  workarounds.
affects:
  ranges:
  - type: ECOSYSTEM
    fixed: 1.28.0
references:
- type: WEB
  url: https://pypi.org/project/matrix-synapse/
- type: WEB
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-5wrh-4jwv-5w78
- type: WEB
  url: https://github.com/matrix-org/synapse/pull/9240
aliases:
- CVE-2021-21392
modified: "2021-04-26T18:40:00Z"
published: "2021-04-12T22:15:00Z"
