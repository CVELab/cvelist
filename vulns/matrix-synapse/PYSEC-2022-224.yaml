id: PYSEC-2022-224
details: 'Synapse is an open source home server implementation for the Matrix chat
  network. In versions prior to 1.61.1 URL previews of some web pages can exhaust
  the available stack space for the Synapse process due to unbounded recursion. This
  is sometimes recoverable and leads to an error for the request causing the problem,
  but in other cases the Synapse process may crash altogether. It is possible to exploit
  this maliciously, either by malicious users on the homeserver, or by remote users
  sending URLs that a local user''s client may automatically request a URL preview
  for. Remote users are not able to exploit this directly, because the URL preview
  endpoint is authenticated. Deployments with `url_preview_enabled: false` set in
  configuration are not affected. Deployments with `url_preview_enabled: true` set
  in configuration **are** affected. Deployments with no configuration value set for
  `url_preview_enabled` are not affected, because the default is `false`. Administrators
  of homeservers with URL previews enabled are advised to upgrade to v1.61.1 or higher.
  Users unable to upgrade should set `url_preview_enabled` to false.'
affected:
- package:
    name: matrix-synapse
    ecosystem: PyPI
    purl: pkg:pypi/matrix-synapse
  ranges:
  - type: GIT
    repo: https://github.com/matrix-org/synapse
    events:
    - introduced: "0"
    - fixed: fa1308061802ac7b7d20e954ba7372c5ac292333
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 1.61.1
references:
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-22p3-qrh9-cx32
- type: WEB
  url: https://spec.matrix.org/v1.2/client-server-api/#get_matrixmediav3preview_url
- type: FIX
  url: https://github.com/matrix-org/synapse/commit/fa1308061802ac7b7d20e954ba7372c5ac292333
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QGSDQ4YAITCUACAB7SXQZDJIU3IQ4CJD/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7EARKKJZ2W7WUITFDT4EG4NVATFYJQHF/
aliases:
- CVE-2022-31052
- GHSA-22p3-qrh9-cx32
modified: "2022-07-09T00:15:00Z"
published: "2022-06-28T17:15:00Z"
