id: PYSEC-0000-CVE-2022-23522
details: MindsDB is an open source machine learning platform. An unsafe extraction
  is being performed using `shutil.unpack_archive()` from a remotely retrieved tarball.
  Which may lead to the writing of the extracted files to an unintended location.
  This vulnerability is sometimes called a **TarSlip** or a **ZipSlip variant**. Unpacking
  files using the high-level function `shutil.unpack_archive()` from a potentially
  malicious tarball without validating that the destination file path remained within
  the intended destination directory may cause files to be overwritten outside the
  destination directory. An attacker could craft a malicious tarball with a filename
  path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely
  using a personal bucket `s3`, thus, retrieve the tarball through **mindsdb** and
  overwrite the system files of the hosting server. This issue has been addressed
  in version 22.11.4.3. Users are advised to upgrade. Users unable to upgrade should
  avoid ingesting archives from untrusted sources.
affected:
- package:
    name: mindsdb
    ecosystem: PyPI
    purl: pkg:pypi/mindsdb
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 22.11.4.3
references:
- type: EVIDENCE
  url: https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp
- type: ADVISORY
  url: https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp
aliases:
- CVE-2022-23522
- GHSA-7x45-phmr-9wqp
modified: "2023-04-10T16:22:00Z"
published: "2023-03-30T19:15:00Z"
