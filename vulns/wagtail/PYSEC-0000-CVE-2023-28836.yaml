id: PYSEC-0000-CVE-2023-28836
details: Wagtail is an open source content management system built on Django. Starting
  in version 1.5 and prior to versions 4.1.4 and 4.2.2, a stored cross-site scripting
  (XSS) vulnerability exists on ModelAdmin views within the Wagtail admin interface.
  A user with a limited-permission editor account for the Wagtail admin could potentially
  craft pages and documents that, when viewed by a user with higher privileges, could
  perform actions with that user's credentials. The vulnerability is not exploitable
  by an ordinary site visitor without access to the Wagtail admin, and only affects
  sites with ModelAdmin enabled. For page, the vulnerability is in the "Choose a parent
  page" ModelAdmin view (`ChooseParentView`), available when managing pages via ModelAdmin.
  For documents, the vulnerability is in the ModelAdmin Inspect view (`InspectView`)
  when displaying document fields. Patched versions have been released as Wagtail
  4.1.4 and Wagtail 4.2.2. Site owners who are unable to upgrade to the new versions
  can disable or override the corresponding functionality.
affected:
- package:
    name: wagtail
    ecosystem: PyPI
    purl: pkg:pypi/wagtail
  ranges:
  - type: GIT
    repo: https://github.com/wagtail/wagtail
    events:
    - introduced: "0"
    - fixed: eefc3381d37b476791610e5d30594fae443f33af
    - fixed: bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713
    - fixed: 5be2b1ed55fd7259dfdf2c82e7701dba407b8b62
    - fixed: ff806ab173a504395fdfb3139eb0a29444ab4b91
  - type: ECOSYSTEM
    events:
    - introduced: "4.2"
    - fixed: 4.2.2
    - introduced: "1.5"
    - fixed: 4.1.4
references:
- type: WEB
  url: https://github.com/wagtail/wagtail/releases/tag/v4.2.2
- type: WEB
  url: https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview
- type: ADVISORY
  url: https://github.com/wagtail/wagtail/security/advisories/GHSA-5286-f2rf-35c2
- type: WEB
  url: https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview
- type: FIX
  url: https://github.com/wagtail/wagtail/commit/eefc3381d37b476791610e5d30594fae443f33af
- type: FIX
  url: https://github.com/wagtail/wagtail/commit/bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713
- type: FIX
  url: https://github.com/wagtail/wagtail/commit/5be2b1ed55fd7259dfdf2c82e7701dba407b8b62
- type: FIX
  url: https://github.com/wagtail/wagtail/commit/ff806ab173a504395fdfb3139eb0a29444ab4b91
aliases:
- CVE-2023-28836
- GHSA-5286-f2rf-35c2
modified: "2023-04-10T13:45:00Z"
published: "2023-04-03T17:15:00Z"
