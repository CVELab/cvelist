id: PYSEC-2019-138
package:
  name: waitress
  ecosystem: PyPI
summary: Vulnerability in waitress
details: In Waitress through version 1.4.0, if a proxy server is used in front of
  waitress, an invalid request may be sent by an attacker that bypasses the front-end
  and is parsed differently by waitress leading to a potential for HTTP request smuggling.
  Specially crafted requests containing special whitespace characters in the Transfer-Encoding
  header would get parsed by Waitress as being a chunked request, but a front-end
  server would use the Content-Length instead as the Transfer-Encoding header is considered
  invalid due to containing invalid characters. If a front-end server does HTTP pipelining
  to a backend Waitress server this could lead to HTTP request splitting which may
  lead to potential cache poisoning or unexpected information disclosure. This issue
  is fixed in Waitress 1.4.1 through more strict HTTP field validation.
affects:
  ranges:
  - type: GIT
    repo: https://github.com/Pylons/waitress
    fixed: 11d9e138125ad46e951027184b13242a3c1de017
  - type: ECOSYSTEM
    fixed: 1.4.1
references:
- type: WEB
  url: https://github.com/Pylons/waitress/commit/11d9e138125ad46e951027184b13242a3c1de017
- type: WEB
  url: https://github.com/github/advisory-review/pull/14604
- type: WEB
  url: https://docs.pylonsproject.org/projects/waitress/en/latest/#security-fixes
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GVDHR2DNKCNQ7YQXISJ45NT4IQDX3LJ7/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYEOTGWJZVKPRXX2HBNVIYWCX73QYPM5/
- type: WEB
  url: https://access.redhat.com/errata/RHSA-2020:0720
aliases:
- CVE-2019-16789
modified: "2020-02-25T17:15:00Z"
published: "2019-12-26T17:15:00Z"
